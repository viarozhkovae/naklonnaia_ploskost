<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Котик на горке: Физический симулятор</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #8a4fff;
      --primary-dark: #6b2fd6;
      --secondary: #ff6b8b;
      --accent: #00d4aa;
      --accent2: #ffb74d;
      --dark: #2d2b55;
      --light: #f9f7ff;
      --gray: #e0d6ff;
      --shadow: 0 10px 30px rgba(138, 79, 255, 0.15);
      --shadow-hover: 0 15px 40px rgba(138, 79, 255, 0.25);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f9f7ff 0%, #eef2ff 100%);
      min-height: 100vh;
      padding: 20px;
      color: var(--dark);
      position: relative;
      overflow-x: hidden;
    }

    /* Котики в фоне */
    .cat-bg {
      position: fixed;
      z-index: -1;
      opacity: 0.1;
      font-size: 2rem;
    }

    .cat1 { top: 10%; left: 5%; }
    .cat2 { top: 15%; right: 8%; }
    .cat3 { bottom: 20%; left: 7%; }
    .cat4 { bottom: 10%; right: 5%; }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      position: relative;
    }

    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 10px;
    }

    .logo i {
      font-size: 3rem;
      color: var(--primary);
      filter: drop-shadow(0 5px 10px rgba(138, 79, 255, 0.3));
    }

    h1 {
      font-size: 2.8rem;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 10px;
      font-weight: 800;
    }

    .subtitle {
      font-size: 1.2rem;
      color: #666;
      max-width: 600px;
      margin: 0 auto 20px;
      line-height: 1.6;
    }

    .main-content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-bottom: 40px;
    }

    .controls-panel {
      flex: 1;
      min-width: 320px;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: var(--shadow);
      border: 2px solid var(--gray);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .controls-panel:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-hover);
    }

    .panel-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.8rem;
      margin-bottom: 25px;
      color: var(--dark);
    }

    .panel-title i {
      color: var(--primary);
    }

    .control-group {
      margin-bottom: 25px;
    }

    .control-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--dark);
    }

    .value-display {
      background: var(--light);
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
      color: var(--primary-dark);
    }

    .slider-container {
      position: relative;
      height: 40px;
      display: flex;
      align-items: center;
    }

    input[type="range"] {
      width: 100%;
      height: 10px;
      -webkit-appearance: none;
      background: linear-gradient(to right, var(--gray), var(--primary));
      border-radius: 10px;
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: white;
      border: 3px solid var(--primary);
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      transition: all 0.2s;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(138, 79, 255, 0.4);
    }

    input[type="number"] {
      width: 100px;
      padding: 12px 15px;
      border: 2px solid var(--gray);
      border-radius: 12px;
      font-size: 1rem;
      text-align: center;
      background: white;
      transition: all 0.3s;
    }

    input[type="number"]:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(138, 79, 255, 0.1);
      outline: none;
    }

    .btn-start {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      border-radius: 15px;
      font-size: 1.3rem;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-top: 20px;
      transition: all 0.3s;
      box-shadow: 0 8px 20px rgba(138, 79, 255, 0.3);
    }

    .btn-start:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 25px rgba(138, 79, 255, 0.4);
    }

    .btn-start:active {
      transform: translateY(0);
    }

    .simulation-area {
      flex: 2;
      min-width: 400px;
      background: white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: var(--shadow);
      border: 2px solid var(--gray);
      display: flex;
      flex-direction: column;
    }

    .canvas-container {
      position: relative;
      padding: 20px;
      background: linear-gradient(145deg, #f0ecff, #ffffff);
      flex-grow: 1;
    }

    canvas {
      display: block;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      width: 100%;
      height: 400px;
    }

    .status-panel {
      background: linear-gradient(90deg, #f0ecff, #e6f7ff);
      padding: 20px;
      border-top: 2px solid var(--gray);
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #status {
      font-size: 1.3rem;
      font-weight: 700;
      text-align: center;
      padding: 12px 25px;
      border-radius: 15px;
      background: white;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 15px;
      transition: transform 0.3s;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-icon {
      width: 50px;
      height: 50px;
      background: var(--light);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--primary);
    }

    .stat-info h3 {
      font-size: 0.9rem;
      color: #777;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--dark);
    }

    /* Новая секция с фактами */
    .facts-section {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin-top: 30px;
      box-shadow: var(--shadow);
      border: 2px solid var(--gray);
    }

    .facts-title {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 2rem;
      margin-bottom: 25px;
      color: var(--dark);
      text-align: center;
      justify-content: center;
    }

    .facts-title i {
      color: var(--secondary);
    }

    .facts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
    }

    .fact-card {
      background: var(--light);
      border-radius: 15px;
      padding: 25px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
      border-left: 5px solid var(--accent2);
    }

    .fact-card:nth-child(2) {
      border-left-color: var(--secondary);
    }

    .fact-card:nth-child(3) {
      border-left-color: var(--primary);
    }

    .fact-card:nth-child(4) {
      border-left-color: var(--accent);
    }

    .fact-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .fact-icon {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 1.8rem;
      color: rgba(0, 0, 0, 0.1);
    }

    .fact-content h3 {
      font-size: 1.3rem;
      color: var(--dark);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .fact-content h3 i {
      color: var(--accent2);
    }

    .fact-content p {
      color: #555;
      line-height: 1.6;
      font-size: 1.05rem;
    }

    .physics-formula {
      background: rgba(255, 255, 255, 0.7);
      padding: 10px 15px;
      border-radius: 10px;
      margin-top: 10px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: var(--primary-dark);
      border: 1px dashed var(--gray);
    }

    footer {
      text-align: center;
      padding: 20px;
      color: #777;
      font-size: 0.9rem;
      border-top: 1px solid var(--gray);
      margin-top: 40px;
    }

    .cat-paw {
      color: var(--secondary);
      margin: 0 5px;
    }

    @media (max-width: 900px) {
      .main-content {
        flex-direction: column;
      }
      
      .controls-panel, .simulation-area {
        width: 100%;
      }
      
      h1 {
        font-size: 2.2rem;
      }
      
      .facts-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Анимации */
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .floating {
      animation: float 3s ease-in-out infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    /* Стили для разных фаз */
    .status-moving { color: var(--primary-dark); background: #e8f4ff; }
    .status-stationary { color: #777; background: #f5f5f5; }
    .status-falling { color: var(--secondary); background: #fff0f3; }
    .status-complete { color: var(--accent); background: #e8fff7; }
  </style>
</head>
<body>
  <!-- Котики в фоне -->
  <div class="cat-bg cat1"><i class="fas fa-cat"></i></div>
  <div class="cat-bg cat2"><i class="fas fa-paw"></i></div>
  <div class="cat-bg cat3 floating"><i class="fas fa-cat"></i></div>
  <div class="cat-bg cat4"><i class="fas fa-paw"></i></div>

  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-cat fa-3x floating"></i>
        <h1>Котик на горке</h1>
        <i class="fas fa-sliders-h fa-3x floating" style="animation-delay: 0.5s"></i>
      </div>
      <p class="subtitle">Исследуйте физику движения по наклонной плоскости вместе с нашим пушистым другом! Изменяйте параметры и наблюдайте за движением котика в реальном времени.</p>
    </header>

    <div class="main-content">
      <div class="controls-panel">
        <div class="panel-title">
          <i class="fas fa-sliders-h"></i>
          <h2>Параметры симуляции</h2>
        </div>

        <div class="control-group">
          <div class="control-label">
            <span><i class="fas fa-angle-right" style="color: var(--primary);"></i> Угол наклона (°)</span>
            <span class="value-display" id="angleValue">30</span>
          </div>
          <div class="slider-container">
            <input type="range" id="angleInput" min="0" max="89" step="1" value="30" class="slider">
          </div>
          <input type="number" id="angleNumber" value="30" min="0" max="89" step="1">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span><i class="fas fa-weight-hanging" style="color: var(--primary);"></i> Масса котика (кг)</span>
            <span class="value-display" id="massValue">2.0</span>
          </div>
          <div class="slider-container">
            <input type="range" id="massInput" min="0.1" max="10" step="0.1" value="2" class="slider">
          </div>
          <input type="number" id="massNumber" value="2" min="0.1" step="0.1">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span><i class="fas fa-friction" style="color: var(--primary);"></i> Коэффициент трения (μ)</span>
            <span class="value-display" id="muValue">0.20</span>
          </div>
          <div class="slider-container">
            <input type="range" id="muInput" min="0" max="2" step="0.01" value="0.2" class="slider">
          </div>
          <input type="number" id="muNumber" value="0.2" min="0" max="2" step="0.01">
        </div>

        <button id="startBtn" class="btn-start pulse">
          <i class="fas fa-play-circle"></i>
          Запустить симуляцию
        </button>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-tachometer-alt"></i>
            </div>
            <div class="stat-info">
              <h3>Ускорение</h3>
              <div class="stat-value" id="accelerationValue">0.00 м/с²</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-balance-scale"></i>
            </div>
            <div class="stat-info">
              <h3>Сила трения</h3>
              <div class="stat-value" id="frictionValue">0.00 Н</div>
            </div>
          </div>
        </div>
      </div>

      <div class="simulation-area">
        <div class="canvas-container">
          <canvas id="simCanvas" width="700" height="400"></canvas>
        </div>
        <div class="status-panel">
          <div id="status">Котик готов к спуску! Измените параметры и запустите симуляцию.</div>
        </div>
      </div>
    </div>

    <!-- Новая секция с фактами -->
    <section class="facts-section fade-in">
      <div class="facts-title">
        <i class="fas fa-lightbulb"></i>
        <h2>Коты и физика: удивительные факты</h2>
      </div>
      
      <div class="facts-grid">
        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-cat"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-falling"></i> Коты всегда приземляются на лапы</h3>
            <p>Коты обладают уникальным вестибулярным аппаратом и гибким позвоночником, что позволяет им переворачиваться в воздухе при падении. Этот эффект называется "кошачьим правоминг-рефлексом". Кот может перевернуться, даже падая с высоты всего 30 см!</p>
            <div class="physics-formula">
              Угловая скорость: ω = Δθ/Δt
            </div>
          </div>
        </div>
        
        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-tachometer-alt"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-running"></i> Максимальная скорость кота</h3>
            <p>Домашний кот может развивать скорость до 48 км/ч на коротких дистанциях. Ускорение кота при прыжке может достигать 3g! Для сравнения: космонавты при старте ракеты испытывают перегрузку около 4g.</p>
            <div class="physics-formula">
              Кинетическая энергия: E<sub>k</sub> = ½mv²
            </div>
          </div>
        </div>
        
        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-weight-hanging"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-compress-alt"></i> Коэффициент трения лап</h3>
            <p>Подушечки лап кота имеют уникальную текстуру, которая создает высокий коэффициент трения (примерно 0.6-0.8 на гладких поверхностях). Это позволяет котам резко останавливаться и менять направление движения.</p>
            <div class="physics-formula">
              Сила трения: F<sub>тр</sub> = μ·N
            </div>
          </div>
        </div>
        
        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-wind"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-feather-alt"></i> Аэродинамика кошачьего тела</h3>
            <p>При падении с большой высоты коты инстинктивно расправляют лапы, увеличивая площадь поверхности и снижая скорость падения. Это напоминает парашют, что позволяет им выживать при падении с высоты до 32 этажей!</p>
            <div class="physics-formula">
              Сила сопротивления: F = ½·ρ·v²·C<sub>d</sub>·A
            </div>
          </div>
        </div>

        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-temperature-low"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-thermometer-half"></i> Теплопроводность кошачьей шерсти</h3>
            <p>Шерсть кота — прекрасный теплоизолятор. Воздушная прослойка между волосками уменьшает теплопроводность в 10 раз по сравнению с голой кожей. Именно поэтому коты так любят теплые места!</p>
            <div class="physics-formula">
              Тепловой поток: Q = k·A·ΔT/Δx
            </div>
          </div>
        </div>

        <div class="fact-card">
          <div class="fact-icon">
            <i class="fas fa-eye"></i>
          </div>
          <div class="fact-content">
            <h3><i class="fas fa-binoculars"></i> Физика кошачьего зрения</h3>
            <p>Глаза кота могут пропускать в 6 раз больше света, чем человеческие. Это достигается благодаря tapetum lucidum — отражающему слою за сетчаткой. Именно поэтому глаза кошек светятся в темноте!</p>
            <div class="physics-formula">
              Закон отражения: θ<sub>пад</sub> = θ<sub>отр</sub>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p><i class="fas fa-heart cat-paw"></i>  Изучайте физику с котиками! <i class="fas fa-heart cat-paw"></i></p>
      <p style="margin-top: 10px; font-size: 0.8rem;">Используются упрощенные физические модели для демонстрации</p>
    </footer>
  </div>

  <script>
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');
    
    // Элементы управления
    const angleSlider = document.getElementById('angleInput');
    const angleNumber = document.getElementById('angleNumber');
    const angleValue = document.getElementById('angleValue');
    
    const massSlider = document.getElementById('massInput');
    const massNumber = document.getElementById('massNumber');
    const massValue = document.getElementById('massValue');
    
    const muSlider = document.getElementById('muInput');
    const muNumber = document.getElementById('muNumber');
    const muValue = document.getElementById('muValue');
    
    const startBtn = document.getElementById('startBtn');
    const statusEl = document.getElementById('status');
    const accelerationValue = document.getElementById('accelerationValue');
    const frictionValue = document.getElementById('frictionValue');

    const g = 9.81;
    const scale = 40;

    const tableStartX = 100;
    const tableStartY = 120;
    const tableLength = 400;
    const groundY = 340; // Изменено для нового размера canvas
    const blockSize = 30;

    let simRunning = false;
    let lastTime = 0;
    let phase = 'onTable';

    let alphaRad = degToRad(30);
    let mu = 0.2;
    let mass = 2.0;
    let accelerationOnTable = 0;
    let willMove = true;

    let x = 0, y = 0;     
    let vx = 0, vy = 0;    
    let rotation = 0;      
    let angularVel = 0;

    // Координаты для рисования котика
    const catParts = [
      { x: 0, y: -5, size: 4 },  // левое ухо
      { x: 0, y: -5, size: 4 },  // правое ухо
      { x: 0, y: 0, size: 10 },   // голова
      { x: 0, y: 8, size: 12 },   // тело
      { x: -6, y: 12, size: 3 },  // левая лапа
      { x: 6, y: 12, size: 3 },   // правая лапа
      { x: 0, y: 15, size: 6 }    // хвост
    ];

    function degToRad(deg) { return deg * Math.PI / 180; }

    // Синхронизация элементов управления
    function syncAngle() {
      const value = parseFloat(angleSlider.value);
      angleNumber.value = value;
      angleValue.textContent = value;
    }

    function syncMass() {
      const value = parseFloat(massSlider.value);
      massNumber.value = value.toFixed(1);
      massValue.textContent = value.toFixed(1);
    }

    function syncMu() {
      const value = parseFloat(muSlider.value);
      muNumber.value = value.toFixed(2);
      muValue.textContent = value.toFixed(2);
    }

    angleSlider.addEventListener('input', () => {
      syncAngle();
      updatePhysics();
    });
    
    angleNumber.addEventListener('input', () => {
      let value = Math.min(89, Math.max(0, parseFloat(angleNumber.value) || 0));
      angleSlider.value = value;
      syncAngle();
      updatePhysics();
    });

    massSlider.addEventListener('input', () => {
      syncMass();
      updatePhysics();
    });
    
    massNumber.addEventListener('input', () => {
      let value = Math.max(0.1, parseFloat(massNumber.value) || 1);
      massSlider.value = value;
      syncMass();
      updatePhysics();
    });

    muSlider.addEventListener('input', () => {
      syncMu();
      updatePhysics();
    });
    
    muNumber.addEventListener('input', () => {
      let value = Math.max(0, parseFloat(muNumber.value) || 0);
      muSlider.value = value;
      syncMu();
      updatePhysics();
    });

    // Инициализация
    syncAngle();
    syncMass();
    syncMu();

    function drawTable() {
      const endX = tableStartX + tableLength * Math.cos(alphaRad);
      const endY = tableStartY + tableLength * Math.sin(alphaRad);

      // Тень стола
      ctx.shadowColor = 'rgba(0,0,0,0.1)';
      ctx.shadowBlur = 10;
      ctx.shadowOffsetX = 3;
      ctx.shadowOffsetY = 3;
      
      // Стол
      ctx.strokeStyle = '#7b5dc9';
      ctx.lineWidth = 10;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(tableStartX, tableStartY);
      ctx.lineTo(endX, endY);
      ctx.stroke();
      
      // Ножки стола
      ctx.strokeStyle = '#5d43a3';
      ctx.lineWidth = 8;
      ctx.beginPath();
      ctx.moveTo(tableStartX, tableStartY);
      ctx.lineTo(tableStartX, groundY);
      ctx.moveTo(endX, endY);
      ctx.lineTo(endX, groundY);
      ctx.stroke();
      
      // Сброс тени
      ctx.shadowColor = 'transparent';
      
      // Пол
      ctx.strokeStyle = '#b3a8d9';
      ctx.lineWidth = 4;
      ctx.setLineDash([10, 5]);
      ctx.beginPath();
      ctx.moveTo(0, groundY);
      ctx.lineTo(canvas.width, groundY);
      ctx.stroke();
      ctx.setLineDash([]);
      
      // Декоративные элементы
      ctx.fillStyle = '#8a4fff';
      ctx.fillRect(tableStartX - 5, tableStartY - 5, 10, 10);
      ctx.fillRect(endX - 5, endY - 5, 10, 10);
      
      // Угол наклона
      ctx.strokeStyle = '#ff6b8b';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.arc(tableStartX, tableStartY, 40, 0, alphaRad, false);
      ctx.stroke();
      
      ctx.fillStyle = '#ff6b8b';
      ctx.font = 'bold 16px Arial';
      ctx.fillText(`α = ${parseFloat(angleSlider.value)}°`, tableStartX + 30, tableStartY - 10);
    }

    function drawCat(x, y, angle) {
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate(angle);
      
      // Определяем цвет котика в зависимости от фазы
      let mainColor, accentColor;
      if (phase === 'onGround') {
        mainColor = '#00d4aa';
        accentColor = '#00997a';
      } else if (phase === 'falling') {
        mainColor = '#ff6b8b';
        accentColor = '#d44d6e';
      } else {
        mainColor = willMove ? '#8a4fff' : '#b3a8d9';
        accentColor = willMove ? '#6b2fd6' : '#8a7fb0';
      }
      
      // Тело котика
      ctx.fillStyle = mainColor;
      ctx.strokeStyle = accentColor;
      ctx.lineWidth = 2;
      
      // Тело (овал)
      ctx.beginPath();
      ctx.ellipse(0, 8, 12, 8, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      
      // Голова
      ctx.beginPath();
      ctx.arc(0, 0, 10, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      
      // Уши
      ctx.beginPath();
      ctx.moveTo(-4, -8);
      ctx.lineTo(-8, -12);
      ctx.lineTo(-2, -10);
      ctx.closePath();
      ctx.fill();
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(4, -8);
      ctx.lineTo(8, -12);
      ctx.lineTo(2, -10);
      ctx.closePath();
      ctx.fill();
      ctx.stroke();
      
      // Глаза
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.arc(-3, -1, 3, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(3, -1, 3, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.fillStyle = '#2d2b55';
      ctx.beginPath();
      ctx.arc(-3, -1, 1.5, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(3, -1, 1.5, 0, Math.PI * 2);
      ctx.fill();
      
      // Нос
      ctx.fillStyle = '#ff6b8b';
      ctx.beginPath();
      ctx.arc(0, 2, 1.5, 0, Math.PI * 2);
      ctx.fill();
      
      // Усы
      ctx.strokeStyle = '#2d2b55';
      ctx.lineWidth = 1;
      for(let i = 0; i < 3; i++) {
        ctx.beginPath();
        ctx.moveTo(0, 2);
        ctx.lineTo(-8 - i*2, 0 - i);
        ctx.stroke();
        
        ctx.beginPath();
        ctx.moveTo(0, 2);
        ctx.lineTo(8 + i*2, 0 - i);
        ctx.stroke();
      }
      
      // Лапы
      ctx.fillStyle = mainColor;
      ctx.strokeStyle = accentColor;
      ctx.beginPath();
      ctx.ellipse(-6, 12, 3, 2, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      
      ctx.beginPath();
      ctx.ellipse(6, 12, 3, 2, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      
      // Хвост (анимированный, если движется)
      if (simRunning && phase !== 'onGround') {
        const tailAngle = Math.sin(Date.now() / 100) * 0.3;
        ctx.rotate(tailAngle);
      }
      
      ctx.beginPath();
      ctx.moveTo(0, 8);
      ctx.quadraticCurveTo(5, 15, 0, 20);
      ctx.quadraticCurveTo(-5, 15, 0, 8);
      ctx.fill();
      ctx.stroke();
      
      ctx.restore();
    }

    function resetBlock() {
      const d = blockSize / 2;
      const Px = tableStartX + d * Math.cos(alphaRad);
      const Py = tableStartY + d * Math.sin(alphaRad);

      x = Px + (blockSize / 2) * Math.sin(alphaRad);
      y = Py - (blockSize / 2) * Math.cos(alphaRad);

      vx = vy = 0;
      rotation = alphaRad;
      angularVel = 0;
    }

    function renderPreview() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawTable();
      resetBlock();
      drawCat(x, y, rotation);
    }

    function updatePhysics() {
      const angleDeg = parseFloat(angleSlider.value) || 0;
      mass = parseFloat(massSlider.value) || 1;
      mu = parseFloat(muSlider.value) || 0;

      alphaRad = degToRad(angleDeg);
      const tanAlpha = Math.tan(alphaRad);
      willMove = tanAlpha > mu;
      
      // Вычисление физических величин
      const frictionForce = mu * mass * g * Math.cos(alphaRad);
      accelerationOnTable = willMove ? g * (Math.sin(alphaRad) - mu * Math.cos(alphaRad)) : 0;
      
      // Обновление статистики
      accelerationValue.textContent = willMove ? `${accelerationOnTable.toFixed(2)} м/с²` : "0.00 м/с²";
      frictionValue.textContent = `${frictionForce.toFixed(2)} Н`;
      
      // Обновление статуса
      if (willMove) {
        statusEl.textContent = `Котик готов спускаться! Ускорение: ${accelerationOnTable.toFixed(2)} м/с²`;
        statusEl.className = "status-moving";
        startBtn.classList.add('pulse');
      } else {
        statusEl.textContent = `Котик останется на месте (μ = ${mu.toFixed(2)}, tg α = ${tanAlpha.toFixed(3)})`;
        statusEl.className = "status-stationary";
        startBtn.classList.remove('pulse');
      }

      renderPreview();
    }

    function simulate(timestamp) {
      if (!simRunning) return;

      if (!lastTime) lastTime = timestamp;
      const dt = Math.min((timestamp - lastTime) / 1000, 0.05); // Ограничение dt для стабильности
      lastTime = timestamp;

      rotation += angularVel * dt;

      if (phase === 'onTable') {
        if (willMove) {
          const a = accelerationOnTable;
          let vAlong = Math.sqrt(vx*vx + vy*vy) / scale;
          vAlong += a * dt;
          vx = vAlong * Math.cos(alphaRad) * scale;
          vy = vAlong * Math.sin(alphaRad) * scale;

          x += vx * dt;
          y += vy * dt;

          rotation = alphaRad;

          const tableEndX = tableStartX + tableLength * Math.cos(alphaRad);
          const tableEndY = tableStartY + tableLength * Math.sin(alphaRad);
          const dx = x - tableEndX;
          const dy = y - tableEndY;
          const proj = dx * Math.cos(alphaRad) + dy * Math.sin(alphaRad);

          if (proj >= -blockSize/3) {
            phase = 'falling';
            angularVel = 0;
            statusEl.textContent = `Котик в свободном падении!`;
            statusEl.className = "status-falling";
          }
        }
      } else if (phase === 'falling') {
        vy += g * scale * dt;
        x += vx * dt;
        y += vy * dt;
        
        // Вращение при падении
        angularVel += 0.5 * dt;

        if (y + 20 >= groundY - 2) {
          y = groundY - 20;
          vx *= 0.3;
          vy = 0;
          rotation = 0;
          angularVel = 0;
          phase = 'onGround';
          statusEl.textContent = `Котик благополучно приземлился!`;
          statusEl.className = "status-complete";
          simRunning = false;
          startBtn.innerHTML = '<i class="fas fa-redo"></i> Запустить снова';
        }
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawTable();
      drawCat(x, y, rotation);

      if (phase !== 'onGround') {
        requestAnimationFrame(simulate);
      }
    }

    startBtn.addEventListener('click', () => {
      if (simRunning) return;

      updatePhysics();
      resetBlock();
      phase = 'onTable';
      simRunning = true;
      lastTime = 0;
      
      startBtn.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Симуляция запущена';
      startBtn.classList.remove('pulse');

      requestAnimationFrame(simulate);
    });

    // Инициализация
    updatePhysics();
    
    // Добавляем анимацию тени для canvas
    canvas.style.boxShadow = '0 10px 30px rgba(138, 79, 255, 0.2)';
    canvas.style.transition = 'box-shadow 0.3s';
    
    canvas.addEventListener('mouseenter', () => {
      canvas.style.boxShadow = '0 15px 40px rgba(138, 79, 255, 0.3)';
    });
    
    canvas.addEventListener('mouseleave', () => {
      canvas.style.boxShadow = '0 10px 30px rgba(138, 79, 255, 0.2)';
    });

    // Анимация появления фактов при прокрутке
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);

    // Применяем анимацию к карточкам фактов
    document.querySelectorAll('.fact-card').forEach(card => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
      observer.observe(card);
    });
  </script>
</body>
</html>